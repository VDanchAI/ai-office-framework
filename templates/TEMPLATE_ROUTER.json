{
  "_comment": [
    "ШАБЛОН ИЕРАРХИЧЕСКОГО РОУТЕРА",
    "Используйте, когда ваша KB содержит 20+ секций.",
    "Архитектура: Мастер-роутер (уровень домена) → Под-роутеры (уровень секций).",
    "Этап 1: Мастер определяет, к какому домену относится запрос.",
    "Этап 2: Под-роутер находит точную секцию внутри этого домена.",
    "",
    "Для KB менее 20 секций используйте плоский роутер внутри TEMPLATE_KB.md.",
    "",
    "КАК ИСПОЛЬЗОВАТЬ ЭТОТ ШАБЛОН:",
    "1. Определите ваши домены (3–5 тематических групп секций)",
    "2. Заполните Мастер-роутер ниже (маршрутизация на уровне доменов)",
    "3. Создайте под-роутеры для каждого домена (маршрутизация на уровне секций)",
    "4. Встройте полный JSON в начало файла KB под заголовком ## ROUTER",
    "5. Убедитесь, что каждый якорь в роутере соответствует заголовку в контенте KB"
  ],

  "router_version": "1.0.0",
  "router_type": "hierarchical_master",
  "kb_name": "[BOT_NAME]_Knowledge_Base",
  "kb_version": "1.0",
  "total_sections": 18,
  "total_domains": 3,
  "last_updated": "YYYY-MM-DD",

  "architecture": {
    "type": "hierarchical",
    "domains": 3,
    "sub_routers": 3,
    "master_routing": "Решение на уровне домена → делегирование под-роутеру",
    "benefits": [
      "Масштабируется до сотен секций",
      "Чёткое разделение доменов",
      "Быстрая маршрутизация (два этапа)",
      "Независимое развитие доменов"
    ]
  },

  "maintenance": {
    "changelog": [
      "1.0.0 - Начальная настройка роутера"
    ],
    "update_instructions": {
      "when_section_added_to_existing_domain": [
        "1. Добавить якорь в контент KB",
        "2. Обновить соответствующий под-роутер (не Мастер)",
        "3. Обновить section_count домена в Мастере",
        "4. Увеличить версию под-роутера на +0.1"
      ],
      "when_new_domain_added": [
        "1. Создать новый под-роутер для домена",
        "2. Добавить домен в Мастер-роутер",
        "3. Добавить домен в ai_decision_tree",
        "4. Увеличить версию Мастера на +1.0"
      ]
    }
  },

  "ai_instructions": {
    "routing_strategy": [
      "ЭТАП 1 (Мастер): Определить, к какому домену относится запрос",
      "ЭТАП 2 (Под-роутер): Найти точную секцию внутри этого домена",
      "Если запрос охватывает несколько доменов: направить ВО ВСЕ релевантные домены",
      "При неопределённости: использовать фоллбэк"
    ],
    "execution_order": [
      "1. Проанализировать намерение и контекст запроса",
      "2. Сопоставить с описаниями доменов и context_tags",
      "3. Если совпадение найдено → прочитать под-роутер этого домена",
      "4. Под-роутер сопоставляет запрос с конкретной секцией (секциями)",
      "5. Перейти к якорю (якорям) секции, прочитать контент",
      "6. Если совпадений нет → применить фоллбэк"
    ],
    "fallback": "Направить в DOMAIN_A (фундаментальный домен)"
  },

  "domains": {
    "DOMAIN_A": {
      "description": "Ключевая экспертиза — фундаментальные навыки и знания",
      "sections": ["S1", "S2", "S3", "S4", "S5", "S6"],
      "section_count": 6,
      "sub_router": "domain_a_router",
      "priority": 10,
      "when_to_use": "Любой запрос о [базовой теме], [базовом навыке], [фундаментальной концепции]",
      "context_tags": ["тег1", "тег2", "тег3", "тег4"]
    },

    "DOMAIN_B": {
      "description": "Специализированная экспертиза — продвинутые техники",
      "sections": ["S7", "S8", "S9", "S10", "S11", "S12"],
      "section_count": 6,
      "sub_router": "domain_b_router",
      "priority": 8,
      "when_to_use": "Запросы о [продвинутой теме], [специализированной технике]",
      "context_tags": ["тег5", "тег6", "тег7"]
    },

    "DOMAIN_C": {
      "description": "Прикладная экспертиза — практическое применение",
      "sections": ["S13", "S14", "S15", "S16", "S17", "S18"],
      "section_count": 6,
      "sub_router": "domain_c_router",
      "priority": 6,
      "when_to_use": "Запросы о [практическом применении], [использовании в реальных условиях]",
      "context_tags": ["тег8", "тег9", "тег10"]
    }
  },

  "sub_routers": {

    "domain_a_router": {
      "version": "1.0",
      "domain": "DOMAIN_A",
      "sections": [
        {
          "id": "S1",
          "title": "[Основы]",
          "anchor": "#S1_FOUNDATIONS",
          "triggers": ["ключевое_слово1", "ключевое_слово2", "фраза первая"],
          "description": "Базовые принципы и фундаментальные знания",
          "priority": 10
        },
        {
          "id": "S2",
          "title": "[Ключевой навык]",
          "anchor": "#S2_KEY_SKILL",
          "triggers": ["ключевое_слово3", "ключевое_слово4"],
          "description": "Основной набор навыков",
          "priority": 8
        },
        {
          "id": "S3",
          "title": "[Методы]",
          "anchor": "#S3_METHODS",
          "triggers": ["ключевое_слово5", "ключевое_слово6"],
          "description": "Методы и подходы",
          "priority": 6
        },
        {
          "id": "S4",
          "title": "[Правила]",
          "anchor": "#S4_RULES",
          "triggers": ["ключевое_слово7", "ключевое_слово8"],
          "description": "Правила, специфичные для домена",
          "priority": 6
        },
        {
          "id": "S5",
          "title": "[Форматы]",
          "anchor": "#S5_FORMATS",
          "triggers": ["ключевое_слово9", "ключевое_слово10"],
          "description": "Форматы результатов и шаблоны",
          "priority": 4
        },
        {
          "id": "S6",
          "title": "[Примеры]",
          "anchor": "#S6_EXAMPLES",
          "triggers": ["ключевое_слово11", "ключевое_слово12", "пример", "покажи"],
          "description": "Примеры и справочные материалы",
          "priority": 4
        }
      ]
    },

    "domain_b_router": {
      "version": "1.0",
      "domain": "DOMAIN_B",
      "_comment": "Заполните по аналогии с domain_a_router",
      "sections": []
    },

    "domain_c_router": {
      "version": "1.0",
      "domain": "DOMAIN_C",
      "_comment": "Заполните по аналогии с domain_a_router",
      "sections": []
    }
  }
}
