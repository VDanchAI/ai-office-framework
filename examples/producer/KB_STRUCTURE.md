# KB Продюсера — Обзор структуры

## Параметры файла

| Свойство | Значение |
|---|---|
| Версия | v2.4 |
| Всего строк | 3182 |
| Основных секций | 31 |
| Подсекций | 77 |
| Версия роутера | v5.2 (плоский) |

## Архитектура: основные секции + контекстные подсекции

KB использует **архитектуру плоского роутера** (v5.2). Каждая секция — именованный блок, извлекаемый по точному ключу. Подсекции встроены внутрь родительских секций и адресуются через точечную нотацию (например, `LAUNCH_PHASES.PRE_LAUNCH`).

Это означает:
- Нет вложенных файлов или папок — всё хранится в одной плоской KB
- Роутер разрешает ключи секций в момент запроса, а не при загрузке
- Подсекции контекстные: активируются только при извлечении родительской секции и совпадении запроса с ключом подсекции

## Карта секций

### Основные секции планирования

| № | Ключ секции | Описание | Подсекций |
|---|---|---|---|
| 1 | `AUTOMATION_OVERVIEW` | Что можно автоматизировать в запусках; паттерны n8n и Airtable | 3 |
| 2 | `LAUNCH_PHASES` | Структура и определения этапов пре-лонча, лонча, пост-лонча | 6 |
| 3 | `BACKWARD_PLANNING` | Построение таймлайна от дедлайна, критический путь, картирование зависимостей | 4 |
| 4 | `CHANNEL_MATRIX` | Координация многоканальной кампании: какие каналы, последовательность, правила синхронизации | 5 |
| 5 | `BOT_COORDINATION` | Правила делегирования, протоколы создания брифов, последовательность передачи задач | 4 |
| 6 | `LAUNCH_BRIEF_TEMPLATE` | Мастер-шаблон центрального документа планирования | 7 |

### Операционные секции

| № | Ключ секции | Описание | Подсекций |
|---|---|---|---|
| 7 | `METRICS` | Определения KPI, контрольные точки отслеживания, форматы отчётности | 4 |
| 8 | `COMMON_MISTAKES` | Паттерны выявления рисков, сценарии провалов, сигналы раннего предупреждения | 5 |
| 9 | `COMMUNICATION_TEMPLATES` | Протоколы коммуникации в сессии, форматы статусных обновлений | 3 |
| 10–31 | *(дополнительные секции)* | Вспомогательные справочные материалы, чеклисты, обработка нестандартных случаев | 36 |

**Итого подсекций по всем секциям: 77**

## Логика плоского роутера (v5.2)

```
запрос → роутер → совпадение ключа секции → извлечение блока секции
                                           → если присутствует ключ подсекции → извлечение блока подсекции
                                           → возврат в контекстное окно
```

Ключевые свойства плоского роутера:

- **Одноуровневое разрешение**: роутер не рекурсирует. Он сопоставляет один ключ на запрос.
- **Сквозная передача подсекций**: если запрос содержит и ключ секции, и ключ подсекции, роутер возвращает блок подсекции, а не полную секцию.
- **Без разрешения неоднозначностей**: если запрос совпадает с несколькими ключами, роутер выбирает по приоритетному рангу (задаётся в конфигурации роутера, а не в KB).
- **Без состояния**: роутер не хранит состояние сессии. Каждое извлечение независимо.

## Соглашение об именовании подсекций

Подсекции следуют паттерну: `КЛЮЧ_РОДИТЕЛЯ.ИМЯ_ПОДСЕКЦИИ`

Примеры:
- `LAUNCH_PHASES.PRE_LAUNCH`
- `LAUNCH_PHASES.LAUNCH_DAY`
- `LAUNCH_PHASES.POST_LAUNCH`
- `BACKWARD_PLANNING.CRITICAL_PATH`
- `BOT_COORDINATION.BRIEF_FORMAT`
- `LAUNCH_BRIEF_TEMPLATE.RISK_REGISTER`

## Обоснование дизайна

Плоская архитектура была выбрана вместо иерархической файловой структуры по следующим причинам:

1. **Скорость извлечения** — Поиск по единственному ключу, без обхода директорий
2. **Прозрачность** — Полная карта секций видна в одном месте
3. **Простота поддержки** — Добавление секции не меняет логику роутера
4. **Предсказуемость** — Бот всегда точно знает, что и почему было извлечено
